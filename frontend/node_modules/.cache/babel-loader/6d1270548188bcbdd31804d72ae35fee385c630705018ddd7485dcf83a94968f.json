{"ast":null,"code":"var _jsxFileName = \"F:\\\\Intern years 2\\\\Food-Order\\\\Ordering-Foods\\\\frontend\\\\src\\\\pages\\\\QRScanner.js\",\n  _s = $RefreshSig$();\n// pages/QRScanner.jsx\nimport React, { useEffect } from 'react';\nimport { useNavigate, useSearchParams } from 'react-router-dom';\nimport { Html5Qrcode } from 'html5-qrcode';\nimport { useCart } from '../contexts/CartContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function QRScanner() {\n  _s();\n  const [searchParams] = useSearchParams();\n  const navigate = useNavigate();\n  const {\n    setTableId\n  } = useCart();\n\n  // Nếu URL đã có tableId, chuyển thẳng\n  useEffect(() => {\n    const t = searchParams.get('tableId');\n    if (t) navigate(`/menu/${t}`);\n  }, [searchParams, navigate]);\n  useEffect(() => {\n    const qrRegionId = \"qr-reader\";\n    const html5QrCode = new Html5Qrcode(qrRegionId);\n    html5QrCode.start({\n      facingMode: \"environment\"\n    }, {\n      fps: 10,\n      qrbox: {\n        width: 250,\n        height: 250\n      }\n    }, decodedText => {\n      try {\n        const url = new URL(decodedText);\n        const tableId = url.searchParams.get('tableId');\n        if (tableId) {\n          html5QrCode.stop().then(() => {\n            setTableId(tableId);\n            localStorage.setItem('tableId', tableId);\n            navigate(`/menu/${tableId}`);\n          });\n        }\n      } catch (e) {\n        console.warn(\"Không phải QR hợp lệ:\", decodedText);\n      }\n    }, errorMessage => {\n      // console.log(\"Scan lỗi:\", errorMessage)\n    }).catch(err => console.error(\"Không thể khởi động QR scanner:\", err));\n\n    // cleanup khi unmount\n    return () => {\n      html5QrCode.stop().catch(() => {});\n    };\n  }, [navigate]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"p-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"text-xl mb-4\",\n      children: \"Qu\\xE9t m\\xE3 QR \\u0111\\u1EC3 \\u0111\\u1EB7t m\\xF3n\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 57,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"qr-reader\",\n      style: {\n        width: \"100%\",\n        maxWidth: 400,\n        margin: \"0 auto\"\n      }\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 58,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 5\n  }, this);\n}\n_s(QRScanner, \"pX4oR5tpW3CylwmqOd1ovSImhCc=\", false, function () {\n  return [useSearchParams, useNavigate, useCart];\n});\n_c = QRScanner;\nvar _c;\n$RefreshReg$(_c, \"QRScanner\");","map":{"version":3,"names":["React","useEffect","useNavigate","useSearchParams","Html5Qrcode","useCart","jsxDEV","_jsxDEV","QRScanner","_s","searchParams","navigate","setTableId","t","get","qrRegionId","html5QrCode","start","facingMode","fps","qrbox","width","height","decodedText","url","URL","tableId","stop","then","localStorage","setItem","e","console","warn","errorMessage","catch","err","error","className","children","fileName","_jsxFileName","lineNumber","columnNumber","id","style","maxWidth","margin","_c","$RefreshReg$"],"sources":["F:/Intern years 2/Food-Order/Ordering-Foods/frontend/src/pages/QRScanner.js"],"sourcesContent":["// pages/QRScanner.jsx\r\nimport React, { useEffect } from 'react'\r\nimport { useNavigate, useSearchParams } from 'react-router-dom'\r\nimport { Html5Qrcode } from 'html5-qrcode'\r\nimport { useCart } from '../contexts/CartContext'\r\n\r\nexport default function QRScanner() {\r\n  const [searchParams] = useSearchParams()\r\n  const navigate = useNavigate()\r\n  const { setTableId } = useCart()\r\n\r\n  // Nếu URL đã có tableId, chuyển thẳng\r\n  useEffect(() => {\r\n    const t = searchParams.get('tableId')\r\n    if (t) navigate(`/menu/${t}`)\r\n  }, [searchParams, navigate])\r\n\r\n  useEffect(() => {\r\n    const qrRegionId = \"qr-reader\"\r\n    const html5QrCode = new Html5Qrcode(qrRegionId)\r\n\r\n    html5QrCode.start(\r\n      { facingMode: \"environment\" },\r\n      {\r\n        fps: 10,\r\n        qrbox: { width: 250, height: 250 },\r\n      },\r\n      (decodedText) => {\r\n        try {\r\n          const url = new URL(decodedText)\r\n          const tableId = url.searchParams.get('tableId')\r\n          if (tableId) {\r\n            html5QrCode.stop()\r\n                .then(() => {\r\n                    setTableId(tableId)\r\n                    localStorage.setItem('tableId', tableId)\r\n                    navigate(`/menu/${tableId}`)\r\n            })\r\n          }\r\n        } catch (e) {\r\n          console.warn(\"Không phải QR hợp lệ:\", decodedText)\r\n        }\r\n      },\r\n      (errorMessage) => {\r\n        // console.log(\"Scan lỗi:\", errorMessage)\r\n      }\r\n    ).catch(err => console.error(\"Không thể khởi động QR scanner:\", err))\r\n\r\n    // cleanup khi unmount\r\n    return () => {\r\n      html5QrCode.stop().catch(() => {})\r\n    }\r\n  }, [navigate])\r\n\r\n  return (\r\n    <div className=\"p-4\">\r\n      <h2 className=\"text-xl mb-4\">Quét mã QR để đặt món</h2>\r\n      <div id=\"qr-reader\" style={{ width: \"100%\", maxWidth: 400, margin: \"0 auto\" }} />\r\n    </div>\r\n  )\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}